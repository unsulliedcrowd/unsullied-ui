(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{108:function(e,t,a){e.exports=a(145)},113:function(e,t,a){},114:function(e,t,a){},145:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(21),c=a.n(i),o=(a(113),a(71)),s=a(13),l=a(14),u=a(16),m=a(15),d=a(17),b=a(101),f=a(189),k=a(183),h=a(178),p=a(179),g=a(177),v=a(148),E=a(175),O=a(181),S=a(99),j=a.n(S),w=a(184),y=a(91),I=a.n(y),T=(a(114),a(70)),C=a(39),R=a(53),U=a(33),N=a(174),W=a(30),M=a(31),L=a.n(M),_=a(45),$=a.n(_),B=a(46),P=function(e){function t(e){var a,n=e.state;return Object(s.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this))).state=n,a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(w.a,null),r.a.createElement($.a,{className:"json-pretty",theme:B,data:this.state}))}}]),t}(r.a.Component);function F(){var e=Object(W.a)(["\n  subscription ConfigState {\n    configState ","\n  }\n"]);return F=function(){return e},e}function D(){var e=Object(W.a)(["\n  query ConfigState {\n    configState ","\n  }\n"]);return D=function(){return e},e}var q="\n{\n  schemaFile\n  taskGenerationConfig {\n    initialLocation\n  }\n}",x=L()(D(),q),A=L()(F(),q),Q=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(u.a)(this,Object(m.a)(t).call(this))).state={didSubscribe:!1},e}return Object(d.a)(t,e),Object(l.a)(t,[{key:"_subscribeToState",value:function(e){e({document:A,variables:{},updateQuery:function(e,t){var a=t.subscriptionData;return Object.assign({},{configState:a.data})}})}},{key:"render",value:function(){var e=this;return r.a.createElement("span",null,r.a.createElement(U.c,{query:x,variables:{}},function(t){var a=t.loading,n=t.error,i=t.data,c=t.subscribeToMore;return a?r.a.createElement("div",null,"Fetching"):n?r.a.createElement("div",null,"Error"):(e.state.didSubscribe||(e._subscribeToState(c),e.setState({didSubscribe:!0})),r.a.createElement(P,{state:i.configState}))}))}}]),t}(r.a.Component),J=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(w.a,null),r.a.createElement(N.a,{maxWidth:"md"},r.a.createElement(v.a,{variant:"h6",className:"TitleBar"},"Config"),r.a.createElement(Q,{subscribeToState:this._subscribeToState})))}}]),t}(r.a.Component);function G(){var e=Object(W.a)(["\n  subscription State {\n    currentState ","\n  }\n"]);return G=function(){return e},e}function K(){var e=Object(W.a)(["\n  query State {\n    currentState ","\n  }\n"]);return K=function(){return e},e}var V="\n{\n  currentTime\n  config {\n    schemaFile\n    taskGenerationConfig {\n      initialLocation\n    }\n  }\n\n  crowd {\n    stats {\n      seenWorkersTotal\n      availableWorkersTotal\n    }\n  }\n\n  tasks {\n    stats {\n      availableTasksTotal\n    }\n  }\n\n  knowledge {\n    stats {\n      totalEntityTypes\n    }\n    knownClasses\n  }\n\n}",z=L()(K(),V),H=L()(G(),V),X=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(u.a)(this,Object(m.a)(t).call(this))).state={didSubscribe:!1},e}return Object(d.a)(t,e),Object(l.a)(t,[{key:"_subscribeToState",value:function(e){e({document:H,updateQuery:function(e,t){var a=t.subscriptionData;return Object.assign({},a.data)}})}},{key:"render",value:function(){var e=this;return r.a.createElement(U.c,{query:z,variables:{}},function(t){var a=t.loading,n=t.error,i=t.data,c=t.subscribeToMore;return a?r.a.createElement("div",null,"Fetching"):n?r.a.createElement("div",null,"Error"):(e.state.didSubscribe||(e._subscribeToState(c),e.setState({didSubscribe:!0})),r.a.createElement($.a,{className:"json-pretty",theme:B,data:i.currentState}))})}}]),t}(r.a.Component),Y=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(w.a,null),r.a.createElement(N.a,{maxWidth:"md"},r.a.createElement(v.a,{variant:"h6",className:"TitleBar"},"Dashboard"),r.a.createElement(X,{subscribeToState:this._subscribeToState})))}}]),t}(r.a.Component),Z=a(176),ee=a(188),te=a(187),ae=a(182),ne=a(186);function re(){var e=Object(W.a)(["\n  mutation TaskResult($workerId: ID!, $taskString: String!, $taskResultString: String!, $file: Upload) {\n    submitTaskResult(workerId: $workerId, taskString: $taskString, taskResultString: $taskResultString, file: $file) {\n      isSubmitted\n    }\n  }\n"]);return re=function(){return e},e}var ie=L()(re()),ce=function(e){function t(e){var a,n=e.workerId,r=e.task;return Object(s.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this))).state={workerId:n,task:r,file:null,fileUrl:null,submitted:!1},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"handleFileChange",value:function(e){var t=e.target,a=t.validity,n=Object(o.a)(t.files,1)[0];a.valid&&this.setState({file:n,fileUrl:URL.createObjectURL(n)})}},{key:"submitResult",value:function(e){var t=this;e.preventDefault();var a=JSON.stringify(this.state.task),n=JSON.stringify({taskResult:"test2"});this.props.client.mutate({mutation:ie,variables:{workerId:this.state.workerId,taskString:a,taskResultString:n,file:this.state.file},update:function(){t.setState({submitted:!0})}})}},{key:"handleBooleanChange",value:function(){}},{key:"render",value:function(){var e,t=this;if(this.state.submitted)e=r.a.createElement("div",null,"Task succesfully completed! Waiting for next task...");else if("IMAGE"===this.state.task.resultType)e=r.a.createElement("form",{onSubmit:function(){return t.submitResult.apply(t,arguments)}},r.a.createElement("input",{type:"file",required:!0,onChange:function(){return t.handleFileChange.apply(t,arguments)}}),this.state.fileUrl&&r.a.createElement("img",{src:this.state.fileUrl,className:"imagePreview",alt:"file preview"}),r.a.createElement(E.a,{type:"submit",color:"primary",variant:"contained"},"Submit result!"));else if("BOOLEAN"===this.state.task.resultType){e=r.a.createElement("form",{onSubmit:function(){return t.submitResult.apply(t,arguments)}},r.a.createElement(ee.a,{component:"fieldset"},r.a.createElement(te.a,{component:"legend"},"Label"),r.a.createElement(ne.a,{"aria-label":"Label",name:"gender1",onChange:function(){return t.handleBooleanChange.apply(t,arguments)}},r.a.createElement(Z.a,{value:"is full",control:r.a.createElement(ae.a,null),label:"is full"}),r.a.createElement(Z.a,{value:"isn't full",control:r.a.createElement(ae.a,null),label:"isn't full"}))),r.a.createElement(E.a,{type:"submit",color:"primary",variant:"contained"},"Submit result!"))}return r.a.createElement(r.a.Fragment,null,r.a.createElement(w.a,null),"QUESTION"===this.state.task.interfaceType&&r.a.createElement(v.a,{variant:"h5",className:"TaskQuestionInterface"},this.state.task.taskType," Task: ",this.state.task.interfaceParams[0]),e)}}]),t}(r.a.Component),oe=Object(U.d)(ce),se=function(e){function t(e){var a,n=e.workerId,r=e.workerState;return Object(s.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this))).state={workerId:n,workerState:r},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentWillReceiveProps",value:function(e){e.workerState&&e.workerState!==this.props.workerState&&this.setState({workerState:e.workerState})}},{key:"render",value:function(){var e;return e=null==this.state.workerState.currentTask?r.a.createElement("div",null,"Waiting for task to be assigned..."):r.a.createElement(oe,{task:this.state.workerState.currentTask,workerId:this.state.workerId}),r.a.createElement(r.a.Fragment,null,r.a.createElement(w.a,null),r.a.createElement($.a,{className:"json-pretty",theme:B,data:this.state.workerState}),e)}}]),t}(r.a.Component);function le(){var e=Object(W.a)(["\n  subscription WorkerState($workerId: ID!) {\n    workerState(workerId: $workerId) ","\n  }\n"]);return le=function(){return e},e}function ue(){var e=Object(W.a)(["\n  query WorkerState($workerId: ID!) {\n    workerState(workerId: $workerId) ","\n  }\n"]);return ue=function(){return e},e}function me(){var e=Object(W.a)(["\n  mutation Worker($name: String!) {\n    registerWorker(name: $name) {\n      profile {\n        id\n      }\n    }\n  }\n"]);return me=function(){return e},e}var de="\n{\n  isOnline\n  isWorkingOnTask\n  currentTask {\n    taskType\n    taskParams\n    interfaceType\n    interfaceParams\n    resultType\n    resultParams\n  }\n}",be=L()(me()),fe=L()(ue(),de),ke=L()(le(),de),he=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(u.a)(this,Object(m.a)(t).call(this))).state={didSubscribe:!1,isRegistering:!1,didRegister:!1,workerId:null},e}return Object(d.a)(t,e),Object(l.a)(t,[{key:"_subscribeToState",value:function(e){e({document:ke,variables:{workerId:this.state.workerId},updateQuery:function(e,t){var a=t.subscriptionData;return Object.assign({},a.data)}})}},{key:"render",value:function(){var e=this;return r.a.createElement("span",null,r.a.createElement(U.b,{mutation:be},function(t,a){var n=a.loading,i=a.error;return n?r.a.createElement("div",null,"Registering worker..."):i?r.a.createElement("div",null,"Registration error."):e.state.isRegistering||e.state.didRegister?r.a.createElement("div",null,"Worker registered!"):(e.setState({isRegistering:!0}),t({variables:{name:"Steffan"}}).then(function(t){var a=t.data.registerWorker.profile.id;e.setState({workerId:a,didRegister:!1,isRegistering:!0})}),r.a.createElement("div",null,"Starting worker registration..."))}),this.state.workerId&&r.a.createElement(U.c,{query:fe,variables:{workerId:this.state.workerId}},function(t){var a=t.loading,n=t.error,i=t.data,c=t.subscribeToMore;return a?r.a.createElement("div",null,"Fetching"):n?r.a.createElement("div",null,"Error"):(e.state.didSubscribe||(e._subscribeToState(c),e.setState({didSubscribe:!0})),r.a.createElement(se,{workerState:i.workerState,workerId:e.state.workerId}))}))}}]),t}(r.a.Component),pe=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(w.a,null),r.a.createElement(N.a,{maxWidth:"md"},r.a.createElement(v.a,{variant:"h4",className:"TitleBar"},"Worker UI"),r.a.createElement(he,null)))}}]),t}(r.a.Component),ge=a(96);a(131);var ve=Object({NODE_ENV:"production",PUBLIC_URL:"/unsullied-ui"}),Ee=ve.API_URI,Oe=void 0===Ee?"https://staging-unsullied-api.herokuapp.com/":Ee,Se=ve.PUBLIC_URL,je={API_URI:Oe,PUBLIC_URL:void 0===Se?ge.a:Se},we=a(103),ye=a(97),Ie=a(38),Te=a(3),Ce=a(102),Re=new we.a({uri:je.API_URI.replace("http","ws"),options:{reconnect:!0,timeout:3e4,connectionParams:{}}}),Ue=Object(Ie.split)(function(e){var t=e.query,a=Object(Te.l)(t);return console.log(a.operation),"OperationDefinition"===a.kind&&"subscription"===a.operation},Re,Object(ye.createUploadLink)({uri:je.API_URI,options:{path:"/"}})),Ne=new Ce.a,We=new R.c({link:Ue,cache:Ne}),Me=Object(b.a)({palette:{type:"dark"}}),Le=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(u.a)(this,Object(m.a)(t).call(this))).login=function(){e.setState({logged:!0})},e.logout=function(){e.setState({logged:!1})},e.toggleMenu=function(){e.setState({open:!e.state.open})},e.closeMenu=function(){e.setState({open:!1})},e.selectMenuItem=function(t){e.setState({selectedMenuItem:t}),e.closeMenu()},e.createMenu=function(){return Object.entries(e.menuItems).map(function(t){var a=Object(o.a)(t,2),n=a[0],i=a[1],c=r.a.forwardRef(function(e,t){return r.a.createElement(T.b,Object.assign({innerRef:t,to:i},e),n)});return r.a.createElement(k.a,{className:"MenuItem",onClick:function(){return e.selectMenuItem(n)},component:c,key:n},n)})},e.state={open:!1,logged:!1,selectedMenuItem:null},e.menuItems={Dashboard:"/",Config:"/config","Worker UI":"/worker-ui"},e}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(f.a,{theme:Me},r.a.createElement(w.a,null),r.a.createElement(U.a,{client:We},r.a.createElement(h.a,{position:"static"},r.a.createElement(p.a,null,r.a.createElement(g.a,{edge:"start",className:"MenuIconButton",color:"inherit","aria-label":"Menu",onClick:this.toggleMenu},r.a.createElement(j.a,null)),r.a.createElement(v.a,{variant:"h6",className:"TitleBar"},"UnsulliedKnowledge"),this.state.logged?r.a.createElement(E.a,{variant:"contained",color:"secondary",onClick:this.logout},"Logout"):r.a.createElement(E.a,{variant:"contained",onClick:this.login},"Login"))),r.a.createElement(O.a,{open:this.state.open,docked:"false",onBackdropClick:this.toggleMenu},r.a.createElement("img",{src:I.a,className:"App-logo",alt:"logo"}),this.createMenu()),r.a.createElement(C.a,{exact:!0,path:"/",component:Y}),r.a.createElement(C.a,{path:"/config",component:J}),r.a.createElement(C.a,{path:"/worker-ui",component:pe}))))}}]),t}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(T.a,{basename:"/unsullied-ui"},r.a.createElement(Le,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},91:function(e,t,a){e.exports=a.p+"static/media/logo.5d5d9eef.svg"},96:function(e){e.exports={a:"https://unsulliedcrowd.github.io/unsullied-ui"}}},[[108,1,2]]]);
//# sourceMappingURL=main.4ea336e5.chunk.js.map